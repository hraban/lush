{{define "cmd"}}<!doctype html>
<html>
<head>
    <title>lush cmd {{.Cmd.Id}} - Luyat shell</title>

<style>

.start-btn {
    display: inline;
}

</style>

</head>
<body>

<p><b><a href="/">lush</a></b></p>

<h1>info</h1>
<div class="cmd" id="cmd{{.Cmd.Id}}">
{{.Cmd.Id}}:
<tt>{{range .Cmd.Argv}}{{.}} {{end}}</tt>
{{if .Cmd.Status.Exited}}
    {{if .Cmd.Status.Success}}
        ✓
    {{else}}
        ✗
    {{end}}
{{else}}
    {{if .Cmd.Status.Started}}
        ⌚
    {{else}}
        <form method=post action="/{{.Cmd.Id}}/start" class="start-btn">
            <button>start</button>
        </form>
    {{end}}
{{end}}
</div>

{{with .Cmd.Status.Started}}
<p>started: {{.}}</p>
{{end}}

{{if .Cmd.Status.Exited}}
<p>exited: {{.Cmd.Status.Exited}}</p>
{{with .Cmd.Status.Err}}
<h2>exit status</h2>
<p>{{.Error}}</p>
{{end}}
{{end}}

<h1>I/O</h1>

{{if .Cmd.Status.Started}}
{{if not .Cmd.Status.Exited}}
<h2>stdin</h2>
<form action="send" method="post">
<input type="hidden" name="stream" value="stdin">
<textarea name="data" cols="80" rows="10" wrap="soft"></textarea>
<br>
<button>send</button>
</form>
<form action="close" method="post">
<input type="hidden" name="stream" value="stdin">
<button>EOF</button>
</form>
{{end}}
{{end}}

<h2>stdout</h2>
{{if .Cmd.Status.Started}}
<pre>{{.Stdout}}</pre>
{{else}}
<form action="connect" method="post">
<input type="hidden" name="stream" value="stdout">
connect to:
<select name="to">
    {{range .Connectables}}
    <option value="{{.Id}}">{{.Id}}: {{.Name}}</option>
    {{end}}
</select>
<br>
<button>go</button>
</form>
{{end}}

<h2>stderr</h2>
<pre>{{.Stderr}}</pre>

</body>
</html>
{{end}}
